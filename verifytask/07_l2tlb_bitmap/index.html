<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><script async src="https://www.googletagmanager.com/gtag/js?id=G-4Z2ZY6ZE84"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-4Z2ZY6ZE84")</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?6aacb1c7ca0a3ef4e3aa84c1eaa237dd",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Mulish:wght@300;400;600;700;800&family=Frank+Ruhl+Libre:wght@200;300;400;500;600&family=Encode+Sans+Semi+Condensed:wght@400&display=swap" rel=stylesheet><link rel=stylesheet type=text/css href=/css/bootstrap.min.css><link rel=stylesheet type=text/css href=/css/all.min.css><link disabled id=dark-mode-theme rel=stylesheet href=/css/dark.css><link rel=stylesheet type=text/css href=/css/style.css><link rel=stylesheet type=text/css href=/css/my_style.css><title>万众一芯开放验证 | UT实战第八期：第三代香山(昆明湖）架构 L2TLB-bitmap 模块UT验证实战(进行中)</title>
<meta name=description content="在验证中学习香山L2TLB-bitmap的微架构设计"></head><body style=width:100%;max-width:100%;margin:0;padding:0><nav class="navbar navbar-expand-lg navbar-light bg-light"><div class="d-flex justify-content-between align-items-center" style=width:100%><div class="d-flex align-items-center"><a class="navbar-brand navbar-brand-content" href=https://open-verify.cc/cn><img src=/images/logo.png></a><div class="collapse navbar-collapse" id=navbarNavDropdown><ul class="navbar-nav ms-auto mt-2 mt-lg-0"><li class=nav-item><a class=nav-link href=/registration_portal/>报名入口汇总</a></li><li class=nav-item><a class=nav-link href=/learningresource/>学习资源</a></li><li class=nav-item><a class=nav-link href=/about/>关于我们</a></li></ul></div></div><button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarNavDropdown aria-controls=navbarNavDropdown aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" style=flex:1><ul class="navbar-nav ms-auto mt-2 mt-lg-0"><li class=nav-item><a class="btn fas fa-moon" id=dark-mode-toggle></a></li></ul></div></div></nav><div id=content><div class=container><div class="py-4 rounded-3"><div class="container-fluid py-2"><h1 class="display-2 mb-4 text-center">UT实战第八期：第三代香山(昆明湖）架构 L2TLB-bitmap 模块UT验证实战(进行中)</h1></div><p class="text-center fs-4 fst-italic serif">在验证中学习香山L2TLB-bitmap的微架构设计</p><div class="text-center pt-4"></div></div><div class="row justify-content-center mb-5"><div class=col-12><p class="card-date m-0">Created Aug 22, 2025 -
Last updated: Aug 22, 2025</p><hr class=dropdown-divider><div class="row justify-content-between"><div class=col-sm-4></div><div class=col-sm-8 style=text-align:right></div></div></div></div><div class="container-fluid py-2 content"><div class="serif main-content"><p>本期验证任务将会进一步了解L2TLB-bitmap模块，在验证实战中体会内存隔离的设计思路，加深对TLB和RISCV指令集架构的理解。欢迎各位报名参加（报名填写<a href=https://www.wjx.top/vm/hJJAnOJ.aspx>这里</a>，qq群：<strong>600480230</strong>。）！</p><p>Bitmap 负责在M模式对内存进行动态隔离，用来保护正在使用中的数据的机密性和完整性。bitmap 模块与L2TLB耦合。在L2TLB进行地址翻译获得物理地址后，取得该物理地址的权限，从而判断是否需要隔离。本次任务仅需验证bitmap与L2TLB交互的部分和bitmap本身。L2TLB模块本身已经经过充分验证，可以被认为是可靠的。新增的bitmap部分在Chisel 源码中使用TAG “HasBitmapCheck” 进行标记。
本次验证的Chisel 文件涉及：</p><ul><li>cache/mmu/L2TLB.scala</li><li>cache/mmu/BitmapCheck.scala</li><li>cache/mmu/PageTableWalker.scala</li><li>cache/mmu/PageTableCache.scala</li><li>cache/mmu/MMUBundle.scala</li><li>cache/mmu/MMUConst.scala</li><li>backend/fu/NewCSR/NewCSR.scala</li></ul><p>本次分配的任务是对Bitmap模块的验证，所有的任务都将通过<a href=https://github.com/XS-MLVP/UnityChipForXiangShan/issues target=_blank>万众一芯之香山处理器的issue</a>分配。</p><h2 id=参与>参与</h2><p>本次验证任务请基于UnityChipForXiangShan提供的<a href=https://github.com/XS-MLVP/UnityChipForXiangShan target=_blank>验证框架</a>完成验证工作并向该仓库提交PR。</p><h3 id=成果提交>成果提交</h3><p>请fork上述UnityChipForXiangShan仓库之后完成验证代码和文档的编写，成果齐备后，请发起PR以提交。</p><h3 id=bug报告>bug报告</h3><p>请直接在UnityChipForXiangShan的仓库下使用bug report模板提issue，或者快捷点击<a href="https://github.com/XS-MLVP/UnityChipForXiangShan/issues/new?assignees=&amp;labels=&amp;projects=&amp;template=bug_report.md&amp;title=%5BBUG%5D+">这里</a>。</p><p>提交bug时，请先在label中选择bug need to confirm标签。然后从label提供的四种bug分级（minor、normal、serious、critical）中选择您认为最符合的一种标签。最后，请选择您发现bug的模块，本次验证的是memblock中L2TLB的bitmap模块，可以统一打上ut_memblock.bitmap标签。</p><h2 id=成果需求>成果需求</h2><p>每个子任务需要提交以下成果：</p><ol><li>验证环境+API：验证环境和API是代码成果，是针对待验证对象（DUT）的数据职责（引脚）和行为职责（逻辑）的封装，需要提供特定的可复用的接口、
测试套件、测试覆盖率等的定义。其中，搭建验证环境可以参考<a href=https://open-verify.cc/UnityChipForXiangShan/docs/03_add_test/02_build_env/ target=_blank>验证环境搭建教程</a>，测试覆盖率相关的文档可以参考这两篇：<a href=https://open-verify.cc/UnityChipForXiangShan/docs/03_add_test/04_cover_line/ target=_blank>行覆盖率</a>、<a href=https://open-verify.cc/UnityChipForXiangShan/docs/03_add_test/05_cover_func/ target=_blank>功能覆盖率</a>。</li><li>测试用例：测试用例是代码成果，定义了用于测试的输入组合，以及预期的输出组合。构建测试用例可以参考<a href=https://open-verify.cc/UnityChipForXiangShan/docs/03_add_test/03_add_test/ target=_blank>测试用例添加教程</a></li><li>验证报告：验证报告是文字成果，包括对环境、测试点和测试用例的介绍，复现代码所需的环境和指令，以及对测试覆盖率等衡量指标的报告。</li></ol><ul><li>验证报告的书写可以参考这篇教程：<a href=https://open-verify.cc/mlvp/docs/basic/report/ target=_blank>验证报告教程</a></li></ul><ol start=4><li>其他说明：如果运行您的项目需要其他的依赖，可在测试报告或PR中说明</li></ol><p>本期任务在<a href=https://github.com/XS-MLVP/UnityChipForXiangShan target=_blank>UnityChipForXiangShan验证框架</a>中已经提供了初步的环境，各位也可以自行搭建验证环境和提炼API。</p><h2 id=任务难度>任务难度</h2><p>任务难度是根据理解难度、工作量等因素综合得出的，一般来说难度1～3的任务是简单的任务，4～7的任务难度一般，或许工作量较大，或许需要花费一定时间理解任务隐藏信息，8～10的任务较为困难，一般同时具有较大的工作量和较高的理解难度。</p><h2 id=奖励信息>奖励信息</h2><p>最终,根据任务的难度和各位的完成情况，各位将能获得数额不等的奖金。此外，如果为Bitmap模块找出bug并反馈确认后，有机会得到更多奖金。</p><h2 id=任务详情>任务详情</h2><p>由于本期验证的模块和L2TLB耦合，包含大量交互部分，划分为多个子模块并无实际意义，因而需要对整个Bitmap和L2TLB模块搭建验证环境。我们将通过测试完整度（覆盖率等）进行分级，在验证过程中，您将需要按自选的功能点自行划分测试点进行测试，功能点详细描述请参考 <a href=https://open-verify.cc/UnityChipForXiangShan/docs/98_ut/03_memblock/02_bitmap/>L2TLB-Bitmap 文档</a>。涉及bitmap模块本身的功能点和涉及L2TLB交互的功能点将分别进行标记。Bitmap模块的功能点较为独立，建立优先验证。所有功能点及对应难度如下：</p><h3 id=bitmap--相关功能验证>Bitmap 相关功能验证</h3><table><thead><tr><th><strong>功能标识符</strong></th><th><strong>功能点</strong></th><th><strong>描述</strong></th><th><strong>难度</strong></th></tr></thead><tbody><tr><td>BITMAP_001</td><td>Bitmap Cache hit/miss 场景验证</td><td>设计测试用例覆盖命中和未命中<br><strong>排列组合</strong>：跨 bitmap cache line，即miss和hit都有</td><td>1/10</td></tr><tr><td>BITMAP_002</td><td>Bitmap check 功能验证</td><td>验证 bitmap check 的正确性<br><strong>排列组合</strong>： 跨大于 256K 物理地址空间，即总是miss</td><td>1/10</td></tr><tr><td>BITMAP_003</td><td>跨bitmap cache line 场景验证</td><td>测试跨 cache line 的访问行为<br><strong>排列组合</strong>：跨bitmap cache line + 跨 256k 物理地址空间</td><td>1/10</td></tr><tr><td>BITMAP_004</td><td>BITMAP刷新</td><td>测试csr.mbmc.BCLEAR是否能正常工作</td><td>1/10</td></tr></tbody></table><h3 id=tlb-相关功能验证>TLB 相关功能验证</h3><table><thead><tr><th>功能标识符</th><th>功能点</th><th>覆盖方法描述</th><th>排列组合描述</th><th><strong>难度</strong></th></tr></thead><tbody><tr><td>TLB_001</td><td>ITLB hit/miss 场景验证</td><td>设计测试用例覆盖 ITLB 命中和未命中</td><td>4K/2M/1G/512G 页大小</td><td>3/10</td></tr><tr><td>TLB_002</td><td>DTLB hit/miss 场景验证</td><td>设计测试用例覆盖 DTLB 命中和未命中</td><td>4K/2M/1G/512G 页大小</td><td>3/10</td></tr><tr><td>TLB_003</td><td>L2TLB hit/miss 场景验证</td><td>设计测试用例覆盖 L2TLB 命中和替换</td><td>4K/2M/1G/512G 页大小</td><td>3/10</td></tr><tr><td>TLB_004</td><td>L2TLB 压缩功能验证<br>注：仅支持一阶段地址转换压缩，最多压缩8项</td><td>测试TLB 压缩场景下，Bitmap 查询结果是否正确</td><td>TLB 压缩启用 + 4K 页大小</td><td>4/10</td></tr></tbody></table><h3 id=bitmap-cache-和-tlb-组合相关功能验证>Bitmap Cache 和 TLB 组合相关功能验证</h3><table><thead><tr><th>功能标识符</th><th>功能点</th><th>覆盖方法描述</th><th>排列组合描述</th><th><strong>难度</strong></th></tr></thead><tbody><tr><td>TLB_BITMAP_001</td><td>Bitmap与TLB混合命中场景验证</td><td>组合Bitmap命中与各级TLB命中，验证多级缓存协同</td><td>Bitmap hit + ITLB/DTLB/L2TLB全命中</td><td>3/10</td></tr><tr><td>TLB_BITMAP_002</td><td>全未命中极端场景验证</td><td>设计冷启动或冲刷缓存后首次访问的全未命中用例</td><td>Bitmap miss + ITLB/DTLB/L2TLB全miss + 触发页表遍历</td><td>3/10</td></tr><tr><td>TLB_BITMAP_003</td><td>Bitmap跨行与TLB替换场景验证</td><td>强制Bitmap跨cache line访问并触发TLB替换（如duplicate access或页表更新）</td><td>Bitmap跨行 + DTLB miss + L2TLB替换</td><td>3/10</td></tr><tr><td>TLB_BITMAP_004</td><td>重复访问与Cache/TLB交互验证</td><td>通过相同地址重复访问验证Bitmap/TLB的重复访问优化</td><td>Bitmap重复命中 + ITLB重复命中 + 无替换<br>Bitmap重复Miss + ITLB重复Miss + 替换</td><td>4/10</td></tr></tbody></table><hr><h3 id=页表遍历ptw相关功能验证>页表遍历（PTW）相关功能验证</h3><table><thead><tr><th>功能标识符</th><th>功能点</th><th>覆盖方法描述</th><th>排列组合描述</th><th><strong>难度</strong></th></tr></thead><tbody><tr><td>PTW_001</td><td>PTW/HPTW/LLPTW 优先级验证</td><td>测试多级页表遍历的优先级</td><td>PTW + HPTW 并发</td><td>4/10</td></tr><tr><td>PTW_002</td><td>PTW 返回异常（access fault）验证</td><td>模拟 PTW 返回异常的场景</td><td>PTW return af + 跨Page</td><td>4/10</td></tr><tr><td>PTW_003</td><td>PTE 合法性验证</td><td>测试非法 PTE 的处理</td><td>非法 PTE + PMP check</td><td>4/10</td></tr></tbody></table><hr><h3 id=异常与重放replay功能验证>异常与重放（Replay）功能验证</h3><table><thead><tr><th>功能标识符</th><th>功能点</th><th>覆盖方法描述</th><th>排列组合描述</th><th><strong>难度</strong></th></tr></thead><tbody><tr><td>REPLAY_001</td><td>标量 replay 场景验证</td><td>测试标量指令重放行为</td><td>标量 replay + access fault</td><td>5/10</td></tr><tr><td>REPLAY_002</td><td>向量访存 replay 场景验证</td><td>测试向量指令重放行为</td><td>向量 replay + 跨MMO</td><td>5/10</td></tr><tr><td>EXCEPT_001</td><td>异常优先级验证（access/page fault/guest page fault）</td><td>验证异常触发的优先级</td><td>page fault/guest page fault<br>page table walker 过程中的PMP/bitmap 检测失败<br>转换之后的物理地址PMP 检测失败</td><td>5/10</td></tr></tbody></table><hr><h3 id=特权级与扩展功能验证>特权级与扩展功能验证</h3><table><thead><tr><th>功能标识符</th><th>功能点</th><th>覆盖方法描述</th><th>排列组合描述</th><th><strong>难度</strong></th></tr></thead><tbody><tr><td>PRIV_001</td><td>U/S/M 特权级切换验证</td><td>测试不同特权级下的访问权限</td><td>U/S/M + 4K/2M 页大小</td><td>4/10</td></tr><tr><td>EXT_001</td><td>H-extension 功能验证</td><td>测试 H-extension 启用和禁用场景</td><td>H-extension + 跨tlb entry</td><td>4/10</td></tr><tr><td>PMP_001</td><td>PMP check 功能验证</td><td>测试bitmap 内PMP 权限检查</td><td>PMP Y/N + 跨Page</td><td>4/10</td></tr></tbody></table><hr><h3 id=fense验证>Fense验证</h3><table><thead><tr><th>功能标识符</th><th>功能点</th><th>覆盖方法描述</th><th>排列组合描述</th><th><strong>难度</strong></th></tr></thead><tbody><tr><td>MISC_001</td><td>Fence 操作验证</td><td>测试 fence 指令的同步效果</td><td>Fence + 切换Cmode</td><td>3/10</td></tr></tbody></table><h2 id=报名方式>报名方式</h2><p>请填写<a href=https://www.wjx.top/vm/hJJAnOJ.aspx>报名问卷</a>参与本期任务，也欢迎加入活动官方qq群：<strong>600480230</strong>。</p><p>如有疑问可在qq群中联系群主，或联系万众一芯官方邮箱：unitychip@bosc.ac.cn。</p></div></div></div></div><script src=/js/bootstrap.min.js></script><script src=/js/jquery.min.js></script><script src=/js/isotope.pkgd.min.js></script><script src=/js/masonry.pkgd.min.js async></script><script src=/js/dark.js></script><script>var savedTheme=localStorage.getItem("dark-mode-storage")||"light";setTheme(savedTheme)</script><script src=/js/isotope.js></script><script src=/js/mermaid.min.js></script><script>mermaid.initialize({startOnLoad:!0,securityLevel:"loose"})</script></body></html>