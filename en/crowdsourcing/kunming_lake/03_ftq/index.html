<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><script async src="https://www.googletagmanager.com/gtag/js?id=G-4Z2ZY6ZE84"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-4Z2ZY6ZE84")</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?6aacb1c7ca0a3ef4e3aa84c1eaa237dd",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Mulish:wght@300;400;600;700;800&family=Frank+Ruhl+Libre:wght@200;300;400;500;600&family=Encode+Sans+Semi+Condensed:wght@400&display=swap" rel=stylesheet><link rel=stylesheet type=text/css href=/css/bootstrap.min.css><link rel=stylesheet type=text/css href=/css/all.min.css><link disabled id=dark-mode-theme rel=stylesheet href=/css/dark.css><link rel=stylesheet type=text/css href=/css/style.css><link rel=stylesheet type=text/css href=/css/my_style.css><title>UnityChip Verification | UT Practical Session Phase 4: Third Generation Xiangshan (Kunming Lake) Architecture FTQ Module UT Verification</title>
<meta name=description content="Learning Xiangshan FTQ Microarchitecture Design Through Verification"></head><body style=width:100%;max-width:100%;margin:0;padding:0><nav class="navbar navbar-expand-lg navbar-light bg-light"><div class=container><a class=navbar-brand href=https://open-verify.cc/en><b style=font-weight:800>Home</b>
</a><button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarNavDropdown aria-controls=navbarNavDropdown aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarNavDropdown><ul class="navbar-nav ms-auto mt-2 mt-lg-0"><li class=nav-item><a class=nav-link href=/en/crowdsourcing/>Verification Tasks</a></li><li class=nav-item><a class=nav-link href=/en/learningresource/>Learning Resources</a></li><li class=nav-item><a class=nav-link href=/en/about/>About Us</a></li><li class=nav-item><a class=nav-link href=https://open-verify.cc/crowdsourcing/kunming_lake/03_ftq/>中文</a></li><li class="nav-item px-2 pt-1"><a class="btn fas fa-moon" id=dark-mode-toggle></a></li></ul></div></div></nav><div id=content><div class=container><div class="py-4 rounded-3"><div class="container-fluid py-2"><h1 class="display-2 mb-4 text-center">UT Practical Session Phase 4: Third Generation Xiangshan (Kunming Lake) Architecture FTQ Module UT Verification</h1></div><p class="text-center fs-4 fst-italic serif">Learning Xiangshan FTQ Microarchitecture Design Through Verification</p><div class="text-center pt-4"></div></div><div class="row justify-content-center mb-5"><div class=col-12><p class="card-date m-0">Created Mar 18, 2025 -
Last updated: Mar 18, 2025</p><hr class=dropdown-divider><div class="row justify-content-between"><div class=col-sm-4></div><div class=col-sm-8 style=text-align:right></div></div></div></div><div class="container-fluid py-2"><div class="serif main-content"><p>This verification hands-on task will help in learning the design of the FTQ module in Xiangshan&rsquo;s Kunming Lake architecture. FTQ (Fetch Target Queue) plays a critical role in processor front-end design, responsible for the interaction between the front-end Branch Prediction Unit (BPU) and Instruction Fetch Unit (IFU), as well as the interaction between the front-end and back-end.</p><p>Through this task, you will gain understanding of the FTQ design, while also learning relevant content involved in the IFU and BPU modules, as well as how to use our provided verification framework for processor verification work - making this a comprehensive task that combines knowledge with practice.</p><p><a href=https://open-verify.cc/UnityChipForXiangShan/docs/98_ut/01_frontend/03_ftq/>FTQ Verification Documentation: Provides more detailed introduction about FTQ</a></p><h1 id=participation>Participation</h1><p>For this verification task, please complete the verification work based on the <a href=https://github.com/XS-MLVP/UnityChipForXiangShan>verification framework</a> provided by UnityChipForXiangShan and submit a PR to this repository.</p><h2 id=deliverable-submission>Deliverable Submission</h2><p>Please fork the aforementioned UnityChipForXiangShan repository, complete the verification code and documentation work, and initiate a PR to the main repository when all deliverables are ready.</p><h2 id=bug-report>Bug Report</h2><p>Please directly use the bug report template to file an issue under the UnityChipForXiangShan repository, or quickly click <a href="https://github.com/XS-MLVP/UnityChipForXiangShan/issues/new?assignees=&amp;labels=&amp;projects=&amp;template=bug_report.md&amp;title=%5BBUG%5D+">here</a>.</p><p>When submitting a bug, please first select the <code>bug need to confirm</code> label from the available labels. Then choose one of the four bug severity labels provided (<code>minor</code>, <code>normal</code>, <code>serious</code>, or <code>critical</code>) that best matches your issue. Finally, please select the module where you found the bug. For this verification task focusing on the front-end FTQ module, please uniformly apply the <code>ut_frontend.ftq</code> label.</p><h2 id=deliverable-requirements>Deliverable Requirements</h2><p>Deliverables Required for Each Subtask:</p><ol><li><p><strong>Verification Code</strong>: Please follow the <a href=https://open-verify.cc/UnityChipForXiangShan/docs/03_add_test/>specification</a> when writing code to facilitate testing and unified maintenance. Your code may involve the following components, all of which have defined formats in the specification:</p><ul><li><p><strong>Compilation scripts</strong>: Basic compilation scripts are provided, but you may define your own</p></li><li><p><strong>Test environment</strong>: You can provide verification environments for both <code>classic</code> and <code>toffee</code> versions</p></li><li><p><strong>Test cases</strong>: You need to include instructions in <code>README.md</code> explaining how to execute your test cases</p></li></ul></li><li><p><strong>Verification Report</strong>: Should include:</p><ul><li>Introduction to the environment, test points and test cases</li><li>Environment setup and commands required to reproduce the code</li><li>Metrics report including test coverage<br>Reference tutorial: <a href=https://open-verify.cc/mlvp/docs/basic/report/>Verification Report Guide</a></li></ul></li></ol><p>The current task has provided preliminary environment setup in the <a href=https://github.com/XS-MLVP/UnityChipForXiangShan>UnityChipForXiangShan verification framework</a>, including:</p><ul><li>Compilation scripts for both FTQ sub-queues and top-level</li><li>A random testing example for FTQ sub-queues</li></ul><p>For details, please refer to the &ldquo;Verification Environment&rdquo; section in the FTQ documentation.</p><h1 id=task>Task</h1><h2 id=reward-information>Reward Information</h2><p>Participants will receive varying monetary awards based on task difficulty and completion quality. Additionally, those who identify and report confirmed bugs in the FTQ module will qualify for extra bonuses.</p><h2 id=task-details>Task Details</h2><h3 id=task-1-ftq-sub-queues>Task 1: FTQ Sub-queues</h3><p><em>The FTQ queue is composed of multiple sub-queues, where some sub-queues maintain one category of information while others maintain different categories of information. Sub-queue entries sharing the same ftqIdx collectively constitute a complete FTQ entry.</em></p><p>In this task, you need to verify several critical sub-queues of the FTQ, primarily testing their read/write functionality for correct operation.</p><table><thead><tr><th>Task</th><th>Function Point</th><th>Description</th></tr></thead><tbody><tr><td>FTQ Sub-queue Read/Write</td><td>Fetch Target Sub-queue Read/Write</td><td>ftq_pc_mem stores fetch targets from branch prediction results</td></tr><tr><td></td><td>Redirection Storage Sub-queue Read/Write</td><td>ftq_redirect_mem stores redirection information from branch prediction</td></tr><tr><td></td><td>Pre-decode Storage Sub-queue Read/Write</td><td>ftq_pd_mem stores pre-decoded instruction block information from IFU</td></tr><tr><td></td><td>FTB Entry Storage Sub-queue Read/Write</td><td>ftb_entry_mem stores FTB entries from branch prediction results</td></tr></tbody></table><p>Expected task difficulty：3/10</p><h3 id=task-2-ftq-branch-prediction-interface>Task 2: FTQ Branch Prediction Interface</h3><p><em>The FTQ receives branch prediction results from the BPU and stores them in corresponding sub-queues.</em></p><table><thead><tr><th>Task</th><th>Function Point</th><th>Description</th></tr></thead><tbody><tr><td>FTQ Receives BPU Predictions</td><td>BPU Enqueue Condition</td><td>New FTQ entries are written only when BPU enqueue conditions are satisfied</td></tr><tr><td></td><td>Write FTQ Entry</td><td>Stores branch prediction results in FTQ sub-queues and status queues</td></tr><tr><td></td><td>Redirect Misprediction</td><td>Forwards redirection signals to IFU when BPU predictions are incorrect</td></tr><tr><td></td><td>Update FTQ Pointers</td><td>Modifies BPU/IFU pointers during prediction enqueue or redirection events</td></tr></tbody></table><p>Expected task difficulty：6/10</p><h3 id=task-3-ftq-to-ifu-fetch-target-delivery>Task 3: FTQ-to-IFU Fetch Target Delivery</h3><p><em>The FTQ sends fetch targets to the IFU for pre-decoding.</em></p><table><thead><tr><th>Task</th><th>Function Point</th><th>Description</th></tr></thead><tbody><tr><td>FTQ Sends FTQ Entry to IFU</td><td>Sends Fetch Target to ICache</td><td>FTQ delivers fetch targets to ICache</td></tr><tr><td></td><td>Sends Fetch Target to Prefetch</td><td>FTQ provides fetch targets to Prefetch for speculative fetching</td></tr><tr><td></td><td>Sends Fetch Target to IFU</td><td>FTQ transmits fetch targets to IFU</td></tr><tr><td></td><td>Updates Hit Status Queue</td><td>On fallTruError, FTQ sets status queue to &lsquo;false hit&rsquo;</td></tr><tr><td></td><td>Instruction Flush</td><td>Prediction redirection may flush pending IFU requests</td></tr><tr><td></td><td>Updates Send Status Queue</td><td>Upon successful IFU dispatch, FTQ sets status queue to &lsquo;sent&rsquo;</td></tr></tbody></table><p>Expected task difficulty：6/10</p><h3 id=task-4-ifu-to-ftq-pre-decode-information-writeback>Task 4: IFU to FTQ Pre-decode Information Writeback</h3><p><em>The IFU writes back pre-decoded instruction information to the FTQ&rsquo;s pre-decode storage queue.</em></p><table><thead><tr><th>Task</th><th>Function Point</th><th>Description</th></tr></thead><tbody><tr><td>IFU Writes Back Predecode Info</td><td>Write to ftq_pd_mem</td><td>IFU predecode results will be written to FTQ&rsquo;s pre-decode sub-queue</td></tr><tr><td></td><td>Update Commit Status Queue</td><td>Updates commit status queue based on instruction validity in writeback data</td></tr><tr><td></td><td>Comprehensive Errors</td><td>Error information from predecode results and mismatch with prediction data</td></tr></tbody></table><p>Expected task difficulty：5/10</p><h3 id=task-5-ftq-backend-redirection-handling>Task 5: FTQ Backend Redirection Handling</h3><p><em>The backend refers to the actual instruction execution modules that send redirection signals to the FTQ to correct errors based on runtime execution results.</em></p><table><thead><tr><th>Task</th><th>Function Point</th><th>Description</th></tr></thead><tbody><tr><td>FTQ Receives Backend Redirect</td><td>Sends Fetch Target to Backend</td><td>Backend needs to store information from FTQ</td></tr><tr><td></td><td>Sends Latest FTQ Entry Info</td><td>Transmits the newest FTQ entry information</td></tr></tbody></table><p>Expected task difficulty：5/10</p><h3 id=task-6-ftq-ifu-redirection-handling>Task 6: FTQ IFU Redirection Handling</h3><p><em>In addition to the backend, the IFU also generates redirection signals. Unlike backend redirections, IFU&rsquo;s redirect messages originate from pre-decode writeback information.</em></p><table><thead><tr><th>Task</th><th>Function Point</th><th>Description</th></tr></thead><tbody><tr><td>FTQ Receives IFU Redirect</td><td>Generates IFU Redirect Signals</td><td>The IFU generates redirect signals based on pre-decode results and forwards them</td></tr><tr><td></td><td>Generates IFU Flush Signals</td><td>IFU redirections will produce pipeline flush signals</td></tr></tbody></table><p>Expected task difficulty：4/10</p><h3 id=task-7-ftq-to-backend-fetch-target-deliver>Task 7: FTQ to Backend Fetch Target Deliver</h3><p><em>The fetch target PC will be sent to the backend&rsquo;s PC memory (pc_mem) for storage, enabling local PC access.</em></p><table><thead><tr><th>Task</th><th>Function Point</th><th>Description</th></tr></thead><tbody><tr><td>FTQ Sends Fetch Target to Backend</td><td>Delivers Fetch Target to Backend</td><td>Backend needs to store fetch target information from FTQ</td></tr><tr><td></td><td>Sends Latest FTQ Entry Info</td><td>Transmits the most recent FTQ entry information</td></tr></tbody></table><p>Expected task difficulty：2/10</p><h3 id=task-8-execution-unit-modifies-ftq-status-queue>Task 8: Execution Unit Modifies FTQ Status Queue</h3><p><em>All writeback information from the backend - including both redirection signals and update notifications - is generated post-execution by the actual execution units based on their operational results.</em></p><table><thead><tr><th>Task</th><th>Function Point</th><th>Description</th></tr></thead><tbody><tr><td>Execution Unit Modifies FTQ Status Queue</td><td>Updates Status Queue</td><td>Modifies FTQ status queue based on actual backend execution results</td></tr><tr><td></td><td>Backend Redirect Has Higher Priority</td><td>IFU redirect writeback also modifies status queue, but backend redirect has higher priority</td></tr></tbody></table><p>Expected task difficulty：2/10</p><h3 id=task-9-ftq-pointer-and-status-queue-flush>Task 9: FTQ Pointer and Status Queue Flush</h3><p><em>Redirections triggered by either the backend or IFU require recovery of all FtqPtr types used to index FTQ entries. When the redirection is initiated by the backend, it additionally modifies the commit status queue to indicate the instruction has been executed.</em></p><table><thead><tr><th>Task</th><th>Function Point</th><th>Description</th></tr></thead><tbody><tr><td>Flush FTQ Pointers and Status Queue</td><td>Flush FTQ Pointers</td><td>Redirection signals from either backend or IFU will trigger FTQ pointer flush</td></tr><tr><td></td><td>ROB Commit</td><td>Modifies FTQ commit status queue using ROB commit information</td></tr></tbody></table><p>Expected task difficulty：3/10</p><h3 id=task-10-ftq-to-bpu-update-and-redirection>Task 10: FTQ-to-BPU Update and Redirection</h3><p><em>FTQ sends the update information of committed instructions to the BPU for training, and also forwards redirect signals.</em></p><table><thead><tr><th>Task</th><th>Feature</th><th>Description</th></tr></thead><tbody><tr><td>FTQ sends updates and redirects to BPU</td><td>Forward redirect</td><td>Forwards redirect signals from IFU or backend</td></tr><tr><td></td><td>Commit instruction block</td><td>Determines whether the instruction block can be committed</td></tr><tr><td></td><td>Send BPU update</td><td>FTQ needs to send update information to BPU for training</td></tr><tr><td></td><td>Update FTB entry</td><td>FTQ needs to update old FTB entries and forward them to the update interface</td></tr></tbody></table><p>Expected Difficulty: 8/10</p><h3 id=registration>Registration</h3><p>Please fill out the registration questionnaire to participate in this task. You are also welcome to join the official QQ group: 600480230.<br>If you have any questions, you can contact the group owner in the QQ group, or email UnityChip at <a href=mailto:anxu@bosc.ac.cn>anxu@bosc.ac.cn</a>.</p></div></div></div></div><div class=container><div class="row justify-content-between"><div class=col-sm-4><p class=footer>MLVP Group © 2025</p></div><div class="col-sm-6 d-flex flex-row-reverse"><a class="footer-social px-2" href=# target=_blank><i class="fab fa-weixin"></i></a>
<a class="footer-social px-2" href=# target=_blank><i class="fab fa-weibo"></i></a></div></div></div><script src=/js/bootstrap.min.js></script><script src=/js/jquery.min.js></script><script src=/js/isotope.pkgd.min.js></script><script src=/js/masonry.pkgd.min.js async></script><script src=/js/dark.js></script><script>var savedTheme=localStorage.getItem("dark-mode-storage")||"light";setTheme(savedTheme)</script><script src=/js/isotope.js></script><script src=/js/mermaid.min.js></script><script>mermaid.initialize({startOnLoad:!0,securityLevel:"loose"})</script></body></html>