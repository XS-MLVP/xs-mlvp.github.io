<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><script async src="https://www.googletagmanager.com/gtag/js?id=G-4Z2ZY6ZE84"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-4Z2ZY6ZE84")</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?6aacb1c7ca0a3ef4e3aa84c1eaa237dd",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Mulish:wght@300;400;600;700;800&family=Frank+Ruhl+Libre:wght@200;300;400;500;600&family=Encode+Sans+Semi+Condensed:wght@400&display=swap" rel=stylesheet><link rel=stylesheet type=text/css href=/css/bootstrap.min.css><link rel=stylesheet type=text/css href=/css/all.min.css><link disabled id=dark-mode-theme rel=stylesheet href=/css/dark.css><link rel=stylesheet type=text/css href=/css/style.css><link rel=stylesheet type=text/css href=/css/my_style.css><title>万众一芯开放验证 | UT实战第四期：第三代香山(昆明湖）架构FTQ模块UT验证实战(进行中)</title>
<meta name=description content="在验证中学习香山FTQ的微架构设计"></head><body style=width:100%;max-width:100%;margin:0;padding:0><nav class="navbar navbar-expand-lg navbar-light bg-light"><div class=container><a class=navbar-brand href=https://open-verify.cc/cn><b style=font-weight:800>首页</b>
</a><button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarNavDropdown aria-controls=navbarNavDropdown aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarNavDropdown><ul class="navbar-nav ms-auto mt-2 mt-lg-0"><li class=nav-item><a class=nav-link href=/crowdsourcing/>正在进行的验证任务</a></li><li class=nav-item><a class=nav-link href=/learningresource/>学习资源</a></li><li class=nav-item><a class=nav-link href=/about/>关于我们</a></li><li class=nav-item><a class=nav-link href=https://open-verify.cc/en/crowdsourcing/kunming_lake/03_ftq/>English</a></li><li class="nav-item px-2 pt-1"><a class="btn fas fa-moon" id=dark-mode-toggle></a></li></ul></div></div></nav><div id=content><div class=container><div class="py-4 rounded-3"><div class="container-fluid py-2"><h1 class="display-2 mb-4 text-center">UT实战第四期：第三代香山(昆明湖）架构FTQ模块UT验证实战(进行中)</h1></div><p class="text-center fs-4 fst-italic serif">在验证中学习香山FTQ的微架构设计</p><div class="text-center pt-4"></div></div><div class="row justify-content-center mb-5"><div class=col-12><p class="card-date m-0">Created Mar 18, 2025 -
Last updated: Mar 18, 2025</p><hr class=dropdown-divider><div class="row justify-content-between"><div class=col-sm-4></div><div class=col-sm-8 style=text-align:right></div></div></div></div><div class="container-fluid py-2"><div class="serif main-content"><p>本期验证实战任务将帮助学习香山昆明湖架构中FTQ模块的设计，FTQ是取指目标队列，在处理器前端设计中承担着重要作用，负责前端分支预测单元BPU和取指令单元IFU之间的交互，以及前端与后端之间交互。</p><p>在本次任务中，你将了解FTQ的设计，同时也会了解IFU, BPU中所涉及到的相关内容，以及学习如何使用由我们提供的验证框架进行处理器验证的工作，是一项知行结合的综合性任务。</p><p><a href=https://open-verify.cc/UnityChipForXiangShan/docs/98_ut/01_frontend/03_ftq/>FTQ验证文档：更详细地为你介绍关于FTQ的内容</a></p><h1 id=参与>参与</h1><p>本次验证任务请基于UnityChipForXiangShan提供的<a href=https://github.com/XS-MLVP/UnityChipForXiangShan>验证框架</a>完成验证工作并向该仓库提交PR。</p><h2 id=成果提交>成果提交</h2><p>请fork上述UnityChipForXiangShan仓库之后完成验证代码和文档的编写，成果齐备后，向主仓库发起PR。</p><h2 id=bug报告>bug报告</h2><p>请直接在UnityChipForXiangShan的仓库下使用bug report模板提issue，或者快捷点击<a href="https://github.com/XS-MLVP/UnityChipForXiangShan/issues/new?assignees=&amp;labels=&amp;projects=&amp;template=bug_report.md&amp;title=%5BBUG%5D+">这里</a>。</p><p>提交bug时，请先在label中选择bug need to confirm标签。然后从label提供的四种bug分级（minor、normal、serious、critical）中选择您认为最符合的一种标签。最后，请选择您发现bug的模块，本次验证的是前端的ftq模块，可以统一打上ut_frontend.ftq标签。</p><h2 id=成果需求>成果需求</h2><p>每个子任务需要提交以下成果：</p><ol><li><p>验证代码：请遵照<a href=https://open-verify.cc/UnityChipForXiangShan/docs/03_add_test/>规范</a>编写代码，方便我们进行测试和统一维护。你的代码可能涉及以下内容，它们都在规范中规定了格式：</p><ul><li><p>编译脚本：目前已经提供了相应的编译脚本，但你也可以定义自己的编译脚本</p></li><li><p>测试环境：你可以提供classic和toffee两种版本的验证环境</p></li><li><p>测试用例：你需要在README.md中对如何运行你的测试用例做一定说明</p></li></ul></li><li><p>验证报告：包括对环境、测试点和测试用例的介绍，复现代码所需的环境和指令，以及对测试覆盖率等衡量指标的报告。 验证报告的书写可以参考这篇教程：<a href=https://open-verify.cc/mlvp/docs/basic/report/>验证报告教程</a></p></li></ol><p>本期任务在<a href=https://github.com/XS-MLVP/UnityChipForXiangShan>UnityChipForXiangShan验证框架</a>中已经提供了初步的环境，主要为FTQ子队列和顶层的编译脚本，以及一个对FTQ子队列进行随机测试的范例，具体请参考FTQ文档中验证环境章节介绍。</p><h1 id=任务>任务</h1><h2 id=奖励信息>奖励信息</h2><p>根据任务的难度和各位的完成情况，各位将能获得数额不等的奖金。此外，如果为FTQ模块找出bug并反馈确认后，有机会得到更多奖金。</p><h2 id=任务详情>任务详情</h2><h3 id=任务1-ftq子队列>任务1. FTQ子队列</h3><p><em>FTQ队列，是由好多个子队列共同构成的，一些子队列维护一类信息，另一些子队列维护另一类信息，相同ftqIdx索引的子队列信息共同构成一个完整的FTQ项。</em></p><p>在这个任务中，你需要验证FTQ几个重要子队列，主要验证其读写功能正常。</p><table><thead><tr><th>任务</th><th>功能点</th><th>描述</th></tr></thead><tbody><tr><td>FTQ子队列读写功能</td><td>取指目标子队列读写</td><td>ftq_pc_mem存储来自分支预测结果的取指目标</td></tr><tr><td></td><td>重定向存储子队列读写</td><td>ftq_redirect_mem存储来自分支预测结果的重定向信息</td></tr><tr><td></td><td>预译码存储子队列读写</td><td>ftq_pd_mem存储来自IFU的对指令块的预译码信息</td></tr><tr><td></td><td>FTB项存储子队列读写</td><td>ftb_entry_mem存储自分支预测结果中的FTB项</td></tr></tbody></table><p>预期难度：3/10</p><h3 id=任务2-ftq接收bpu分支预测结果>任务2. FTQ接收BPU分支预测结果</h3><p><em>FTQ将接收BPU的分支预测结果，存储在子队列中</em></p><table><thead><tr><th>任务</th><th>功能点</th><th>描述</th></tr></thead><tbody><tr><td>FTQ接收BPU分支预测结果</td><td>BPU入队条件</td><td>满足允许BPU入队的条件，才能写入新的FTQ项</td></tr><tr><td></td><td>写入FTQ项</td><td>将分支预测结果存入FTQ各个子队列，以及状态队列中</td></tr><tr><td></td><td>转发预测结果重定向</td><td>如果BPU的分支预测结果出错，需要将预测结果重定向信号转发给IFU</td></tr><tr><td></td><td>修正FTQ指针</td><td>BPU预测结果入队，或者预测结果重定向时，会修改相应的BPU指针，以及IFU指针</td></tr></tbody></table><p>预期难度：6/10</p><h3 id=任务3-ftq向ifu发送取指目标>任务3. FTQ向IFU发送取指目标</h3><p><em>FTQ向IFU发送取指目标，让其进行预译码</em></p><table><thead><tr><th>任务</th><th>功能点</th><th>描述</th></tr></thead><tbody><tr><td>FTQ向IFU发送FTQ项</td><td>向ICache发送取指目标</td><td>FTQ会向ICache发送取指目标</td></tr><tr><td></td><td>向Prefetch发送取指目标</td><td>FTQ会向Prefetch发送取指目标进行预取</td></tr><tr><td></td><td>向IFU发送取指目标</td><td>FTQ会向IFU发送取指目标</td></tr><tr><td></td><td>修改命中状态队列</td><td>发生fallTruError时，FTQ会将状态队列设置为false hit</td></tr><tr><td></td><td>指令冲刷</td><td>发生预测结果重定向时，可能会冲刷掉向IFU的发送请求</td></tr><tr><td></td><td>修改发送状态队列</td><td>成功向IFU执行发送请求，FTQ会将状态队列设置为sent</td></tr></tbody></table><p>预期难度：6/10</p><h3 id=任务4-ifu向ftq写回预译码信息>任务4. IFU向FTQ写回预译码信息</h3><p><em>IFU将预译码信息写回FTQ预译码存储队列</em></p><table><thead><tr><th>任务</th><th>功能点</th><th>描述</th></tr></thead><tbody><tr><td>IFU向FTQ写回预译码信息</td><td>写回ftq_pd_mem</td><td>IFU预译码结果将被写入FTQ的预译码子队列</td></tr><tr><td></td><td>更新提交状态队列</td><td>根据写回信息中指令的有效情况更新提交状态队列</td></tr><tr><td></td><td>综合错误</td><td>预译码结果得到的错误信息以及与预测结果比对得到的错误信息</td></tr></tbody></table><p>预期难度：5/10</p><h3 id=任务5-ftq接收后端重定向>任务5. FTQ接收后端重定向</h3><p><em>后端是指令的实际执行模块，根据时机执行的结果，向FTQ发送重定向信息以纠正错误</em></p><table><thead><tr><th>任务</th><th>功能点</th><th>描述</th></tr></thead><tbody><tr><td>FTQ接收后端重定向</td><td>将取指目标发给后端</td><td>后端需要存储来自FTQ的存储信息</td></tr><tr><td></td><td>发送FTQ最新项信息</td><td>发送FTQ最新项信息</td></tr></tbody></table><p>预期难度：5/10</p><h3 id=任务6ftq接收ifu重定向>任务6.FTQ接收IFU重定向</h3><p><em>除了后端，IFU也会发送重定向相关消息，和后端不同，IFU的重定向信息来自于预译码写回信息</em></p><table><thead><tr><th>任务</th><th>功能点</th><th>描述</th></tr></thead><tbody><tr><td>FTQ接收IFU重定向</td><td>生成IFU重定向信息</td><td>IFU会根据预测译码结果生成重定向信号，并进行转发</td></tr><tr><td></td><td>生成IFU冲刷信号</td><td>IFU的重定向会生成冲刷信号</td></tr></tbody></table><p>预期难度：4/10</p><h3 id=任务7-ftq向后端发送取指目标>任务7. FTQ向后端发送取指目标</h3><p><em>pc取指目标会发给后端pc mem进行存储，使其能在本地取PC</em></p><table><thead><tr><th>任务</th><th>功能点</th><th>描述</th></tr></thead><tbody><tr><td>FTQ向后端发送取指目标</td><td>将取指目标发给后端</td><td>后端需要存储来自FTQ的取指目标信息</td></tr><tr><td></td><td>发送FTQ最新项信息</td><td>发送FTQ最新项信息</td></tr></tbody></table><p>预期难度：2/10</p><h3 id=任务8-执行单元修改ftq状态队列>任务8. 执行单元修改FTQ状态队列</h3><p><em>后端的写回信息，包括重定向信息和更新信息，实际上都是执行之后，由实际执行单元根据结果发回的</em></p><table><thead><tr><th>任务</th><th>功能点</th><th>描述</th></tr></thead><tbody><tr><td>执行单元修改FTQ状态队列</td><td>修改状态队列</td><td>根据后端的实际执行结果修改FTQ状态队列</td></tr><tr><td></td><td>后端重定向优先级更高</td><td>IFU的重定向写回信息也会修改相应的状态队列，但后端重定向优先级更高</td></tr></tbody></table><p>预期难度：2/10</p><h3 id=任务9-冲刷ftq指针和状态队列>任务9. 冲刷FTQ指针和状态队列</h3><p><em>由后端或者IFU引起的重定向，需要恢复各种类型用来索引FTQ项的FtqPtr。而当重定向是由后端发起的时候，还要修改提交状态队列，说明指令已经被执行。</em></p><table><thead><tr><th>任务</th><th>功能点</th><th>描述</th></tr></thead><tbody><tr><td>冲刷FTQ指针和状态队列</td><td>冲刷FTQ指针</td><td>后端或者IFU发来的重定向信息会引起FTQ指针的冲刷</td></tr><tr><td></td><td>ROB提交</td><td>通过ROB的commit信息修改FTQ提交状态队列</td></tr></tbody></table><p>预期难度：3/10</p><h3 id=任务10-ftq向bpu发送更新和重定向信息>任务10. FTQ向BPU发送更新和重定向信息</h3><p><em>FTQ将已提交指令的更新信息发往BPU进行训练，同时转发重定向信号。</em></p><table><thead><tr><th>任务</th><th>功能点</th><th>描述</th></tr></thead><tbody><tr><td>FTQ向BPU发送更新和重定向信息</td><td>转发重定向信息</td><td>转发来自IFU或者后端的重定向信号</td></tr><tr><td></td><td>提交指令块</td><td>判断指令块是否能够提交</td></tr><tr><td></td><td>发送BPU更新信息</td><td>FTQ需要向BPU发送更新信息，对其进行训练</td></tr><tr><td></td><td>更新FTB表项</td><td>FTQ需要对旧的FTB表项更新，转发到更新接口</td></tr></tbody></table><p>预期难度：8/10</p><h3 id=报名方式>报名方式</h3><p>请填写报名问卷参与本期任务，也欢迎加入活动官方qq群：600480230。
如有疑问可在qq群中联系群主，或联系万众一芯官方邮箱：anxu@bosc.ac.cn。</p></div></div></div></div><div class=container><div class="row justify-content-between"><div class=col-sm-4><p class=footer>MLVP Group © 2025</p></div><div class="col-sm-6 d-flex flex-row-reverse"><a class="footer-social px-2" href=# target=_blank><i class="fab fa-weixin"></i></a>
<a class="footer-social px-2" href=# target=_blank><i class="fab fa-weibo"></i></a></div></div></div><script src=/js/bootstrap.min.js></script><script src=/js/jquery.min.js></script><script src=/js/isotope.pkgd.min.js></script><script src=/js/masonry.pkgd.min.js async></script><script src=/js/dark.js></script><script>var savedTheme=localStorage.getItem("dark-mode-storage")||"light";setTheme(savedTheme)</script><script src=/js/isotope.js></script><script src=/js/mermaid.min.js></script><script>mermaid.initialize({startOnLoad:!0,securityLevel:"loose"})</script></body></html>